{"remainingRequest":"/home/aigul/projects/rtsp_stream_v2/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/aigul/projects/rtsp_stream_v2/src/views/addCollector.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/aigul/projects/rtsp_stream_v2/src/views/addCollector.vue","mtime":1613943293744},{"path":"/home/aigul/projects/rtsp_stream_v2/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/aigul/projects/rtsp_stream_v2/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBjb250cm9sbGVycyBmcm9tICJAL3ZpZXdzL2NvbnRyb2xsZXJzIjsKZXhwb3J0IGRlZmF1bHQgewpuYW1lOiAiYWRkQ29sbGVjdG9yLnZ1ZSIsCiAgcHJvcHM6IFsnYXJyJywgJ2lkJ10sCiAgY29tcG9uZW50czogewogICAgY29udHJvbGxlcnMKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBpc09wZW46IFt7c3RhdHVzOiB0cnVlfSwge3N0YXR1czogZmFsc2V9XSwKICAgICAgY29udHJvbGxlcnM6IFt7Y2lkOiAnMTInfSwge2NpZDogJ2thamJka2F3J30sIHtjaWQ6ICcxMjM0MjY3MzU3MTY0MjQyMSd9LCB7Y2lkOiAnMWFrbGpiZGFsa2p3YmQyMzQyNDIxJ31dLAogICAgICBzZWxlY3RlZERldmljZXM6IFtdLAogICAgICBjb2x1bW5zOiBbCiAgICAgICAge2tleTogJ2NpZCcsIGxhYmVsOiAnSUQnfSwKICAgICAgICB7a2V5OiAnYnV0dG9uMScsIGxhYmVsOiAn0J/QvtC00LDRgtGMINGB0LjQs9C90LDQuyd9LAogICAgICAgIHtrZXk6ICdidXR0b24yJywgbGFiZWw6ICfQktGL0LHRgNCw0YLRjCd9LAogICAgICBdLAogICAgICBncm91cEFsZXJ0OiBmYWxzZSwKICAgICAgcm9vbU5hbWU6IHRoaXMuJHBhcmVudC5yb29tTmFtZSB8fCAnJywKICAgICAgYXBfc3NpZDogJycsCiAgICAgIGFwX3Bhc3M6ICcnLAogICAgICB0b2tlbjogbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Rva2VuJyksCiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBhc3luYyBnZXRGcmVlRGV2aWNlcygpIHsKICAgICAgbGV0IGRhdGEgPSB7fQogICAgICBmZXRjaChgL2ZyZWVEZXZpY2VzYCwKICAgICAgICAgIHsKICAgICAgICAgICAgbWV0aG9kOiAiUE9TVCIsCiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGRhdGEpLAogICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJywKICAgICAgICAgICAgICAnQWNjZXB0JzogJ2FwcGxpY2F0aW9uL2pzb24nLAogICAgICAgICAgICAgICd0b2tlbic6IHRoaXMudG9rZW4KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICApLnRoZW4ocmVzcG9uc2UgPT4gewoKICAgICAgfSkKICAgIH0sCiAgICBhc3luYyBjaG9vc2VEZXZpdmUoaWQpIHsKICAgICAgY29uc29sZS5sb2coJ2Nob29zaW5nICcgKyBpZCk7CiAgICAgIHRoaXMuc2VsZWN0ZWREZXZpY2VzLnB1c2godGhpcy5jb250cm9sbGVyc1tpZF0pCiAgICAgIHRoaXMuY29udHJvbGxlcnMuc3BsaWNlKGlkLCAxKQogICAgfSwKICAgIGFzeW5jIGRlbGV0ZURldml2ZShpZCwgY2lkKSB7CiAgICAgIGNvbnNvbGUubG9nKCdkZWxldGluZyAnICsgaWQpOwogICAgICB0aGlzLmNvbnRyb2xsZXJzLnB1c2godGhpcy5zZWxlY3RlZERldmljZXNbaWRdKQogICAgICB0aGlzLnJlbW92ZUJ5QXR0cih0aGlzLnNlbGVjdGVkRGV2aWNlcywgJ2NpZCcsIGNpZCkKICAgIH0sCiAgICBhc3luYyByZW1vdmVCeUF0dHIoYXJyLCBhdHRyLCB2YWx1ZSl7CiAgICAgIHZhciBpID0gYXJyLmxlbmd0aDsKICAgICAgd2hpbGUoaS0tKXsKICAgICAgICBpZiggYXJyW2ldCiAgICAgICAgICAgICYmIGFycltpXS5oYXNPd25Qcm9wZXJ0eShhdHRyKQogICAgICAgICAgICAmJiAoYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJyW2ldW2F0dHJdID09PSB2YWx1ZSApICl7CiAgICAgICAgICBhcnIuc3BsaWNlKGksMSk7CgogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gYXJyOwogICAgfSwKICAgIGJsaW5rKGlkKSB7CiAgICAgIGNvbnNvbGUubG9nKCdibGluayAnICsgaWQpCiAgICAgIGxldCBkYXRhID0gewogICAgICAgIGlkOiBpZAogICAgICB9CiAgICAgIGZldGNoKGAvYmxpbmtgLAogICAgICAgICAgewogICAgICAgICAgICBtZXRob2Q6ICJQT1NUIiwKICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoZGF0YSksCiAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLAogICAgICAgICAgICAgICdBY2NlcHQnOiAnYXBwbGljYXRpb24vanNvbicsCiAgICAgICAgICAgICAgJ2lkJzogaWQsCiAgICAgICAgICAgICAgJ3Rva2VuJzogdGhpcy50b2tlbgogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICkKICAgIH0sCiAgICBhc3luYyBjcmVhdGVHcm91cCgpIHsKICAgICAgbGV0IGRhdGEgPSB7CiAgICAgICAgZ3JvdXA6IHRoaXMuc2VsZWN0ZWREZXZpY2VzCiAgICAgIH0KICAgICAgZmV0Y2goYC9jcmVhdGVHcm91cGAsCiAgICAgICAgICB7CiAgICAgICAgICAgIG1ldGhvZDogIlBPU1QiLAogICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShkYXRhKSwKICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsCiAgICAgICAgICAgICAgJ0FjY2VwdCc6ICdhcHBsaWNhdGlvbi9qc29uJywKICAgICAgICAgICAgICAncm9vbU5hbWUnOiB0aGlzLnJvb21OYW1lLAogICAgICAgICAgICAgICdzc2lkJzogIlN0YXJMaWdodF8iICsgdGhpcy5hcF9zc2lkLAogICAgICAgICAgICAgICdwYXNzJzogdGhpcy5hcF9wYXNzLAogICAgICAgICAgICAgICd0b2tlbic6IHRoaXMudG9rZW4KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICApLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIGNvbnNvbGUubG9nKCdydW4gY3JlYXRlIGdyb3VwJykKICAgICAgICB0aGlzLiRwYXJlbnQuc2hvd0FsZXJ0KCfQk9GA0YPQv9C/0LAg0YHQvtC30LTQsNC10YLRgdGPLCDQv9C+0LTQvtC20LTQuNGC0LUnLCAyMDAsICdzdWNjZXNzJykKICAgICAgfSkKICAgIH0sCiAgfQp9Cg=="},{"version":3,"sources":["addCollector.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"addCollector.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"addController\">\n    {{arr}}\n    <div>\n      <b-row class=\"p-2\">\n        <b-col>\n            <h5>Доступные устройства ({{ controllers.length }})</h5>\n            <div class=\"p-2\">\n              <b-table responsive fixed :items=\"controllers\" :fields=\"columns\" table-variant=\"secondary\">\n                <template #cell(button1)=\"row\">\n                  <b-button size=\"sm\" class=\"mr-2\" @click=\"blink(row.item.cid)\">\n                    Сигнал\n                  </b-button>\n                </template>\n                <template #cell(button2)=\"row\">\n                  <b-button size=\"sm\" @click=\"chooseDevive(row.index)\" class=\"mr-2\">\n                    Добавить\n                  </b-button>\n                </template>\n              </b-table>\n            </div>\n        </b-col>\n        <b-col>\n          <div>\n            <h5>Выбранные устройства ({{ selectedDevices.length }})</h5>\n            <div class=\"p-2\">\n              <b-table responsive :items=\"selectedDevices\" :fields=\"columns\" table-variant=\"secondary\">\n                <template #cell(button1)=\"row\">\n                  <b-button size=\"sm\" class=\"mr-2\" @click=\"blink(row.item.cid)\">\n                    Сигнал\n                  </b-button>\n                </template>\n                <template #cell(button2)=\"row\">\n                  <b-button size=\"sm\" @click=\"deleteDevive(row.index, row.item.cid)\" class=\"mr-2\">\n                    Удалить\n                  </b-button>\n                </template>\n              </b-table>\n            </div>\n          </div>\n        </b-col>\n      </b-row>\n    </div>\n\n\n    <div class=\"settings my-3\">\n      <b-card class=\"bg-sec\">\n        <div class=\"text-center mt-2\">\n          <b-button variant=\"dark\" @click=\"groupAlert=true\">Прикрепить к {{arr.length}} областям</b-button>\n        </div>\n      </b-card>\n\n      <div v-if=\"groupAlert\" class=\"fixed-top w-100 h-100\" style=\"z-index: 5; background-color: rgba(0,0,0,0.7)\" />\n      <b-alert\n          dismissible\n          v-model=\"groupAlert\"\n          variant=\"dark\"\n          class=\"position-fixed\"\n          style=\"top: 10vh; left: 10vw; width: 80vw; height: 80vh; z-index: 10; padding: 5%;\"\n      >\n        <div class=\"my-3\">\n          <h3>Создание группы</h3>\n          <div class=\"px-2\">\n            <b-form-input\n                size=\"lg\"\n                class=\"mb-4\"\n                v-model=\"roomName\"\n                placeholder=\"Название помещения\"/>\n            <div class=\"WifiAp\">\n              <h4>WiFi AP</h4>\n              <div class=\"my-2\">\n                <h5 class=\"mb-2\">SSID:</h5>\n                <b-input-group prepend=\"StarLight_\">\n                  <b-form-input v-model=\"ap_ssid\"/>\n                </b-input-group>\n              </div>\n              <div class=\"my-2\">\n                <h5 class=\"mb-2\">Пароль:</h5>\n                <b-form-input v-model=\"ap_pass\"/>\n              </div>\n            </div>\n            <div class=\"text-center mt-4\">\n              <b-button variant=\"dark\" @click=\"createGroup()\">Создать группу</b-button>\n            </div>\n          </div>\n        </div>\n      </b-alert>\n    </div>\n  </div>\n</template>\n\n<script>\nimport controllers from \"@/views/controllers\";\nexport default {\nname: \"addCollector.vue\",\n  props: ['arr', 'id'],\n  components: {\n    controllers\n  },\n  data() {\n    return {\n      isOpen: [{status: true}, {status: false}],\n      controllers: [{cid: '12'}, {cid: 'kajbdkaw'}, {cid: '12342673571642421'}, {cid: '1akljbdalkjwbd2342421'}],\n      selectedDevices: [],\n      columns: [\n        {key: 'cid', label: 'ID'},\n        {key: 'button1', label: 'Подать сигнал'},\n        {key: 'button2', label: 'Выбрать'},\n      ],\n      groupAlert: false,\n      roomName: this.$parent.roomName || '',\n      ap_ssid: '',\n      ap_pass: '',\n      token: localStorage.getItem('token'),\n    }\n  },\n  methods: {\n    async getFreeDevices() {\n      let data = {}\n      fetch(`/freeDevices`,\n          {\n            method: \"POST\",\n            body: JSON.stringify(data),\n            headers: {\n              'Content-Type': 'application/json',\n              'Accept': 'application/json',\n              'token': this.token\n            }\n          }\n      ).then(response => {\n\n      })\n    },\n    async chooseDevive(id) {\n      console.log('choosing ' + id);\n      this.selectedDevices.push(this.controllers[id])\n      this.controllers.splice(id, 1)\n    },\n    async deleteDevive(id, cid) {\n      console.log('deleting ' + id);\n      this.controllers.push(this.selectedDevices[id])\n      this.removeByAttr(this.selectedDevices, 'cid', cid)\n    },\n    async removeByAttr(arr, attr, value){\n      var i = arr.length;\n      while(i--){\n        if( arr[i]\n            && arr[i].hasOwnProperty(attr)\n            && (arguments.length > 2 && arr[i][attr] === value ) ){\n          arr.splice(i,1);\n\n        }\n      }\n      return arr;\n    },\n    blink(id) {\n      console.log('blink ' + id)\n      let data = {\n        id: id\n      }\n      fetch(`/blink`,\n          {\n            method: \"POST\",\n            body: JSON.stringify(data),\n            headers: {\n              'Content-Type': 'application/json',\n              'Accept': 'application/json',\n              'id': id,\n              'token': this.token\n            }\n          }\n      )\n    },\n    async createGroup() {\n      let data = {\n        group: this.selectedDevices\n      }\n      fetch(`/createGroup`,\n          {\n            method: \"POST\",\n            body: JSON.stringify(data),\n            headers: {\n              'Content-Type': 'application/json',\n              'Accept': 'application/json',\n              'roomName': this.roomName,\n              'ssid': \"StarLight_\" + this.ap_ssid,\n              'pass': this.ap_pass,\n              'token': this.token\n            }\n          }\n      ).then(response => {\n        console.log('run create group')\n        this.$parent.showAlert('Группа создается, подождите', 200, 'success')\n      })\n    },\n  }\n}\n</script>"]}]}