{"remainingRequest":"/home/aigul/projects/rtsp_stream_v2/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/aigul/projects/rtsp_stream_v2/src/views/drawArea.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/aigul/projects/rtsp_stream_v2/src/views/drawArea.vue","mtime":1613877990128},{"path":"/home/aigul/projects/rtsp_stream_v2/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/aigul/projects/rtsp_stream_v2/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBKU01wZWcgZnJvbSAnanNtcGVnLXBsYXllcicKY29uc3QgYXJlYV9maWxlID0gcmVxdWlyZSgnLi4vLi4vcHVibGljL2RhdGEuanNvbicpOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdkcmF3QXJlYScsCiAgY29tcG9uZW50czoge30sCiAgZGF0YTogKCkgPT4gKHsKICAgIHBvaW50czogW10sCiAgICBhcmVhX2lkOiAwLAogICAgaTogMCwKICAgIGFycjogW10sCiAgICB4OiBudWxsLCB5OiBudWxsLAogICAgY2FudmFzOiBudWxsLAogICAgY29udGV4dDogbnVsbCwKICAgIGlzRHJhd2luZzogZmFsc2UsCiAgfSksCiAgbW91bnRlZCgpIHsKICAgIGxldCBjYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndmlkZW9DYW52YXMnKTsKICAgIGxldCB1cmwgPSAnd3M6Ly8xOTIuMTY4LjEuMzU6NTAwMCc7CiAgICBsZXQgcGxheWVyID0gbmV3IEpTTXBlZy5QbGF5ZXIodXJsLCB7CiAgICAgIGNhbnZhczogY2FudmFzLAogICAgICBhdXRvcGxheTogdHJ1ZSwgYXVkaW86IGZhbHNlLCBsb29wOiB0cnVlLAogICAgICBvblZpZGVvRGVjb2RlOiAoKSA9PiB7CiAgICAgIH0KICAgIH0pCgogICAgdGhpcy5jYW52YXMgPSB0aGlzLiRyZWZzLmNhbnZhcwogICAgdGhpcy5jb250ZXh0ID0gdGhpcy5jYW52YXMuZ2V0Q29udGV4dCgiMmQiKTsKICAgIHRoaXMuY29udGV4dC5saW5lV2lkdGggPSAyOwogICAgdGhpcy5jb250ZXh0LnN0cm9rZVN0eWxlID0gInJlZCI7CiAgICB0aGlzLmNvbnRleHQuZmlsbFN0eWxlID0gInJnYmEoMCwyNTUsMjU1LDAuNCkiCiAgICB0aGlzLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuY2xpY2spCiAgICB0aGlzLmRyYXdGcm9tU2VydmVyKCkKICB9LAogIG1ldGhvZHM6IHsKICAgIG5ld0FyZWEoKSB7CiAgICAgIHRoaXMuaXNEcmF3aW5nID0gdHJ1ZTsKICAgIH0sCiAgICBjbG9zZUFyZWE6IGZ1bmN0aW9uICgpIHsKICAgICAgdGhpcy5pc0RyYXdpbmcgPSBmYWxzZTsKICAgICAgdmFyIGFyZWEgPSB7ImlkIjogdGhpcy5hcmVhX2lkLCAiZG90cyI6IHRoaXMucG9pbnRzfQogICAgICB0aGlzLmFyZWFfaWQrKzsKICAgICAgdGhpcy5hcnIucHVzaChhcmVhKQoKICAgICAgLy8gdGhpcy53cml0ZUFyZWFzVG9GaWxlKCkKCiAgICAgIHRoaXMucG9pbnRzID0gW10KICAgICAgdGhpcy5pID0gMAogICAgICB0aGlzLnggPSAwOwogICAgICB0aGlzLnkgPSAwOwogICAgICB0aGlzLmNvbnRleHQuY2xvc2VQYXRoKCkKICAgICAgdGhpcy5jb250ZXh0LmZpbGwoKTsKICAgICAgdGhpcy5jb250ZXh0LnN0cm9rZSgpOwogICAgfSwKICAgIGRlbGV0ZUFyZWEoKSB7CiAgICAgIC8vIHRoaXMuY2FudmFzLmNsZWFyKCkKICAgICAgLy8gINCd0KPQltCd0J4g0JTQntCg0JDQkdCe0KLQkNCi0KwKICAgIH0sCiAgICBweFRvUHJvY2VudCh4KXsKICAgICAgdmFyIHJlY3QgPSB0aGlzLmNhbnZhcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgcmV0dXJuICh4L3JlY3Qud2lkdGgpKjEwMAogICAgfSwKICAgIHByb2NlbnRUb1B4KHgpewogICAgICB2YXIgcmVjdCA9IHRoaXMuY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICByZXR1cm4geCpyZWN0LndpZHRoLzEwMAogICAgfSwKICAgIGNsaWNrKGUpIHsKICAgICAgY29uc29sZS5sb2codGhpcy5pc0RyYXdpbmcpCiAgICAgIGlmICghdGhpcy5pc0RyYXdpbmcpIHsKICAgICAgICB0aGlzLm5ld0FyZWEoKQogICAgICB9CiAgICAgIGlmICh0aGlzLmlzRHJhd2luZykgewogICAgICAgIHZhciByZWN0ID0gdGhpcy5jYW52YXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgICAgdmFyIHggPSBlLmNsaWVudFggLSByZWN0LmxlZnQKICAgICAgICB2YXIgeSA9IGUuY2xpZW50WSAtIHJlY3QudG9wOwoKICAgICAgICB0aGlzLnBvaW50cy5wdXNoKHt4LCB5fSkKICAgICAgICBpZiAodGhpcy5pID09IDApIHsKICAgICAgICAgIHRoaXMuY29udGV4dC5iZWdpblBhdGgoKTsKICAgICAgICAgIHRoaXMuY29udGV4dC5tb3ZlVG8oeCwgeSk7CiAgICAgICAgfQogICAgICAgIGlmICh0aGlzLmkgPiAwKSB7CiAgICAgICAgICB0aGlzLmNvbnRleHQubGluZVRvKHgsIHkpOwogICAgICAgICAgdGhpcy5jb250ZXh0LnN0cm9rZSgpOwogICAgICAgICAgaWYgKE1hdGguYWJzKHggLSB0aGlzLnBvaW50c1swXS54KSA8IDEwICYmIE1hdGguYWJzKHkgLSB0aGlzLnBvaW50c1swXS55KSA8IDEwKSB7CiAgICAgICAgICAgIHRoaXMucG9pbnRzLnBvcCgpCiAgICAgICAgICAgIHRoaXMuY2xvc2VBcmVhKCkKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgfQogICAgICB0aGlzLmkrKwogICAgfSwKICAgIGRyYXdGcm9tU2VydmVyKCkgewogICAgICAvLyB0aGlzLmFyci5wdXNoKGFyZWFfZmlsZSkKICAgICAgLy8gdGhpcy5hcmVhX2lkID0gdGhpcy5hcnIubGVuZ3RoCiAgICAgIC8vIHZhciBwb2ludHMKICAgICAgLy8gZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmFyci5sZW5ndGg7IGkrKykgewogICAgICAvLyAgIHBvaW50cyA9IHRoaXMuYXJyW2ldLmRvdHMKICAgICAgLy8gICB0aGlzLmNvbnRleHQuYmVnaW5QYXRoKCkKICAgICAgLy8gICB0aGlzLmNvbnRleHQubW92ZVRvKHBvaW50c1swXS54LCBwb2ludHNbMF0ueSk7CiAgICAgIC8vICAgZm9yICh2YXIgaiA9IDE7IGogPCBwb2ludHMubGVuZ3RoOyBqKyspIHsKICAgICAgLy8gICAgIHZhciB4ID0gcG9pbnRzW2pdLngKICAgICAgLy8gICAgIHZhciB5ID0gcG9pbnRzW2pdLnkKICAgICAgLy8gICAgIHRoaXMuY29udGV4dC5saW5lVG8oeCwgeSk7CiAgICAgIC8vICAgfQogICAgICAvLyAgIHRoaXMuY29udGV4dC5jbG9zZVBhdGgoKQogICAgICAvLyAgIHRoaXMuY29udGV4dC5maWxsKCk7CiAgICAgIC8vICAgdGhpcy5jb250ZXh0LnN0cm9rZSgpOwogICAgICAvLyB9CiAgICB9LAogIH0KfQo="},{"version":3,"sources":["drawArea.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAiBA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"drawArea.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div id=\"app\">\n    <canvas class=\"myCanvas\" id=\"videoCanvas\" style=\"z-index: 10\"/>\n    <div>\n      <canvas ref=\"canvas\" id='drawing-pad' width='1280' height=\"640\" style=\"z-index: 100\" class=\"myCanvas\">\n        This is an interactive drawing pad.\n      </canvas>\n    </div>\n    <div style=\"margin-top: 650px;\"/>\n    <button v-on:click=\"newArea\">Создать область</button>\n    <button v-on:click=\"closeArea\">Замкнуть область</button>\n    <button v-on:click=\"deleteArea\">Удалить область</button>\n  </div>\n</template>\n\n\n<script>\nimport JSMpeg from 'jsmpeg-player'\nconst area_file = require('../../public/data.json');\n\nexport default {\n  name: 'drawArea',\n  components: {},\n  data: () => ({\n    points: [],\n    area_id: 0,\n    i: 0,\n    arr: [],\n    x: null, y: null,\n    canvas: null,\n    context: null,\n    isDrawing: false,\n  }),\n  mounted() {\n    let canvas = document.getElementById('videoCanvas');\n    let url = 'ws://192.168.1.35:5000';\n    let player = new JSMpeg.Player(url, {\n      canvas: canvas,\n      autoplay: true, audio: false, loop: true,\n      onVideoDecode: () => {\n      }\n    })\n\n    this.canvas = this.$refs.canvas\n    this.context = this.canvas.getContext(\"2d\");\n    this.context.lineWidth = 2;\n    this.context.strokeStyle = \"red\";\n    this.context.fillStyle = \"rgba(0,255,255,0.4)\"\n    this.canvas.addEventListener('click', this.click)\n    this.drawFromServer()\n  },\n  methods: {\n    newArea() {\n      this.isDrawing = true;\n    },\n    closeArea: function () {\n      this.isDrawing = false;\n      var area = {\"id\": this.area_id, \"dots\": this.points}\n      this.area_id++;\n      this.arr.push(area)\n\n      // this.writeAreasToFile()\n\n      this.points = []\n      this.i = 0\n      this.x = 0;\n      this.y = 0;\n      this.context.closePath()\n      this.context.fill();\n      this.context.stroke();\n    },\n    deleteArea() {\n      // this.canvas.clear()\n      //  НУЖНО ДОРАБОТАТЬ\n    },\n    pxToProcent(x){\n      var rect = this.canvas.getBoundingClientRect();\n      return (x/rect.width)*100\n    },\n    procentToPx(x){\n      var rect = this.canvas.getBoundingClientRect();\n      return x*rect.width/100\n    },\n    click(e) {\n      console.log(this.isDrawing)\n      if (!this.isDrawing) {\n        this.newArea()\n      }\n      if (this.isDrawing) {\n        var rect = this.canvas.getBoundingClientRect();\n        var x = e.clientX - rect.left\n        var y = e.clientY - rect.top;\n\n        this.points.push({x, y})\n        if (this.i == 0) {\n          this.context.beginPath();\n          this.context.moveTo(x, y);\n        }\n        if (this.i > 0) {\n          this.context.lineTo(x, y);\n          this.context.stroke();\n          if (Math.abs(x - this.points[0].x) < 10 && Math.abs(y - this.points[0].y) < 10) {\n            this.points.pop()\n            this.closeArea()\n            return\n          }\n        }\n\n      }\n      this.i++\n    },\n    drawFromServer() {\n      // this.arr.push(area_file)\n      // this.area_id = this.arr.length\n      // var points\n      // for (var i = 0; i < this.arr.length; i++) {\n      //   points = this.arr[i].dots\n      //   this.context.beginPath()\n      //   this.context.moveTo(points[0].x, points[0].y);\n      //   for (var j = 1; j < points.length; j++) {\n      //     var x = points[j].x\n      //     var y = points[j].y\n      //     this.context.lineTo(x, y);\n      //   }\n      //   this.context.closePath()\n      //   this.context.fill();\n      //   this.context.stroke();\n      // }\n    },\n  }\n}\n</script>\n\n<style>\nbody {\n  margin: 0;\n}\n\n.myCanvas {\n  position: absolute;\n  width: 1280px;\n  height: 640px;\n  top: 50px;\n  left: 10px;\n}\n</style>"]}]}