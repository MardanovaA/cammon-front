{"remainingRequest":"/home/aigul/projects/rtsp_stream_v2/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/aigul/projects/rtsp_stream_v2/src/views/CameraPage.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/aigul/projects/rtsp_stream_v2/src/views/CameraPage.vue","mtime":1614771307757},{"path":"/home/aigul/projects/rtsp_stream_v2/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/aigul/projects/rtsp_stream_v2/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ0NhbWVyYVBhZ2UnLAogIHByb3BzOiBbJ2lkJ10sCiAgZGF0YTogKCkgPT4gKHsKICAgIHBvaW50czogW10sCiAgICBhcmVhX2lkOiAwLAogICAgaTogMCwKICAgIGFycjogW10sCiAgICBvbGRfYXJyOiBbXSwKICAgIHg6IG51bGwsIHk6IG51bGwsCiAgICBjYW52YXM6IG51bGwsCiAgICBjb250ZXh0OiBudWxsLAogICAgaXNEcmF3aW5nOiBmYWxzZSwKICAgIGNob3NlbkFyZWE6IC0xLAogICAgcmVjdDogbnVsbCwKICAgIGNob3NlT2xkQXJlYTogLTEsCiAgfSksCiAgbW91bnRlZCgpIHsKICAgIHRoaXMuY2FudmFzID0gdGhpcy4kcmVmcy5jYW52YXMKICAgIHRoaXMuY29udGV4dCA9IHRoaXMuY2FudmFzLmdldENvbnRleHQoIjJkIik7IC8vY3R4CiAgICB0aGlzLmNvbnRleHQubGluZVdpZHRoID0gMjsKICAgIHRoaXMuY29udGV4dC5mb250ID0gIjIwcHggR2VvcmdpYSI7CiAgICB0aGlzLmNvbnRleHQuc3Ryb2tlU3R5bGUgPSAicmdiKDAsNzAsMTYwKSIKICAgIHRoaXMuY29udGV4dC5maWxsU3R5bGUgPSAicmdiYSgwLDI1NSwyNTUsMC40KSIKICAgIHRoaXMucmVjdCA9IHRoaXMuY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpCiAgICB0aGlzLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuY2xpY2spCiAgICB0aGlzLmRyYXdPbGRBcmVhcygpCiAgICAvLyB0aGlzLmRyYXdGcm9tU2VydmVyKCkKICB9LAogIG1ldGhvZHM6IHsKICAgIGNsb3NlQXJlYTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgYXJlYSA9IHsiaWQiOiB0aGlzLmFyZWFfaWQsICJkb3RzIjogdGhpcy5wb2ludHN9CiAgICAgIGNvbnNvbGUubG9nKHRoaXMucG9pbnRzKQogICAgICB0aGlzLmFyZWFfaWQrKzsKICAgICAgdGhpcy5hcnIucHVzaChhcmVhKQogICAgICAvLyB0aGlzLndyaXRlQXJlYXNUb0ZpbGUoKQogICAgICB0aGlzLnBvaW50cyA9IFtdCiAgICAgIHRoaXMuaSA9IDAKICAgICAgdGhpcy54ID0gbnVsbAogICAgICB0aGlzLnkgPSBudWxsCiAgICAgIHRoaXMuY29udGV4dC5jbG9zZVBhdGgoKQogICAgICB0aGlzLmNvbnRleHQuZmlsbCgpOwogICAgICB0aGlzLmNvbnRleHQuc3Ryb2tlKCk7CiAgICAgIHRoaXMuaXNEcmF3aW5nID0gZmFsc2U7CiAgICB9LAogICAgY2hvc2VBcmVhKGlkKSB7CiAgICAgIHRoaXMuY29udGV4dC5jbGVhclJlY3QoMCwgMCwgdGhpcy5yZWN0LndpZHRoLCB0aGlzLnJlY3QuaGVpZ2h0KQogICAgICB0aGlzLmRyYXdGcm9tQXJyYXkodGhpcy5hcnIpCiAgICAgIHRoaXMuY29udGV4dC5zdHJva2VTdHlsZSA9ICJyZ2JhKDAsMzAsMTUwLCAwLjYpIgogICAgICB0aGlzLmNvbnRleHQuZmlsbFN0eWxlID0gInJnYmEoMCwxMDYsMjU1LCAwLjMpIgogICAgICB0aGlzLmRyYXdGcm9tQXJyYXkodGhpcy5vbGRfYXJyKQogICAgICB0aGlzLmNvbnRleHQuc3Ryb2tlU3R5bGUgPSAicmdiKDAsNzAsMTYwKSIKICAgICAgdGhpcy5jb250ZXh0LmZpbGxTdHlsZSA9ICJyZ2JhKDAsMjU1LDI1NSwgMC40KSIKICAgICAgdGhpcy5jaG9zZW5BcmVhID0gaWQKICAgICAgaWYgKHRoaXMuY2hvc2VPbGRBcmVhID09IDEpIHsKICAgICAgICB2YXIgcG9pbnRzID0gdGhpcy5hcnJbaWRdLmRvdHMKICAgICAgfQogICAgICBlbHNlIGlmICh0aGlzLmNob3NlT2xkQXJlYSA9PSAyKXsKICAgICAgICB2YXIgcG9pbnRzID0gdGhpcy5vbGRfYXJyW2lkXS5kb3RzCiAgICAgIH0KICAgICAgdGhpcy5jb250ZXh0LmJlZ2luUGF0aCgpOwogICAgICB0aGlzLmNvbnRleHQubW92ZVRvKHBvaW50c1swXVswXSwgcG9pbnRzWzBdWzFdKTsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwb2ludHMubGVuZ3RoOyBpKyspIHsKICAgICAgICB0aGlzLmNvbnRleHQubGluZVRvKHBvaW50c1tpXVswXSwgcG9pbnRzW2ldWzFdKQogICAgICB9CiAgICAgIHRoaXMuY29udGV4dC5jbG9zZVBhdGgoKQogICAgICB0aGlzLmNvbnRleHQuc3Ryb2tlU3R5bGUgPSAicmVkIgogICAgICB0aGlzLmNvbnRleHQuZmlsbFN0eWxlID0gInJnYmEoMjU1LDAsMTcwLCAwLjQpIgogICAgICB0aGlzLmNvbnRleHQuZmlsbCgpOwogICAgICB0aGlzLmNvbnRleHQuc3Ryb2tlKCk7CiAgICAgIHRoaXMuY29udGV4dC5zdHJva2VTdHlsZSA9ICJyZ2IoMCw3MCwxNjApIgogICAgICB0aGlzLmNvbnRleHQuZmlsbFN0eWxlID0gInJnYmEoMCwyNTUsMjU1LDAuNCkiCiAgICB9LAogICAgZGVsZXRlQXJlYShpZCkgewogICAgICBpZiAodGhpcy5jaG9zZU9sZEFyZWEgPT0gMSl7CiAgICAgICAgdGhpcy5hcnIuc3BsaWNlKGlkLCAxKQogICAgICB9CiAgICAgIGVsc2UgewogICAgICAgIHZhciBhcl9pZCA9IHRoaXMub2xkX2FycltpZF0uaWQKICAgICAgICAvLyBjb25zb2xlLmxvZyhpZCkKICAgICAgICBheGlvcy5kZWxldGUoYC9hcGkvYXJlYXMvJHthcl9pZH1gKQogICAgICAgICAgICAudGhlbihyZXNwb25zZSA9PiAoY29uc29sZS5sb2cocmVzcG9uc2UpKSk7CiAgICAgICAgdGhpcy5vbGRfYXJyLnNwbGljZShpZCwgMSkKICAgICAgfQogICAgICB0aGlzLmNvbnRleHQuY2xlYXJSZWN0KDAsIDAsIHRoaXMucmVjdC53aWR0aCwgdGhpcy5yZWN0LmhlaWdodCkKICAgICAgdGhpcy5kcmF3RnJvbUFycmF5KHRoaXMuYXJyKQogICAgICB0aGlzLmNvbnRleHQuc3Ryb2tlU3R5bGUgPSAicmdiYSgwLDMwLDE1MCwgMC42KSIKICAgICAgdGhpcy5jb250ZXh0LmZpbGxTdHlsZSA9ICJyZ2JhKDAsMTA2LDI1NSwgMC4zKSIKICAgICAgdGhpcy5kcmF3RnJvbUFycmF5KHRoaXMub2xkX2FycikKCiAgICAgIHRoaXMuY29udGV4dC5zdHJva2VTdHlsZSA9ICJyZ2IoMCw3MCwxNjApIgogICAgICB0aGlzLmNvbnRleHQuZmlsbFN0eWxlID0gInJnYmEoMCwyNTUsMjU1LCAwLjQpIgogICAgICB0aGlzLmNob3NlbkFyZWEgPSAtMQogICAgICB0aGlzLmNob3NlT2xkQXJlYSA9IC0xCiAgICB9LAogICAgZGVsRHJhd2luZ0FyZWEoKSB7CiAgICAgIHRoaXMucG9pbnRzID0gW10KICAgICAgdGhpcy5pID0gMAogICAgICB0aGlzLnggPSBudWxsCiAgICAgIHRoaXMueSA9IG51bGwKICAgICAgdGhpcy5pc0RyYXdpbmcgPSBmYWxzZQoKICAgICAgdGhpcy5jb250ZXh0LmNsZWFyUmVjdCgwLCAwLCB0aGlzLnJlY3Qud2lkdGgsIHRoaXMucmVjdC5oZWlnaHQpCiAgICAgIHRoaXMuZHJhd0Zyb21BcnJheSh0aGlzLmFycikKICAgICAgdGhpcy5jb250ZXh0LnN0cm9rZVN0eWxlID0gInJnYmEoMCwzMCwxNTAsIDAuNikiCiAgICAgIHRoaXMuY29udGV4dC5maWxsU3R5bGUgPSAicmdiYSgwLDEwNiwyNTUsIDAuMykiCiAgICAgIHRoaXMuZHJhd0Zyb21BcnJheSh0aGlzLm9sZF9hcnIpCgogICAgICB0aGlzLmNvbnRleHQuc3Ryb2tlU3R5bGUgPSAicmdiKDAsNzAsMTYwKSIKICAgICAgdGhpcy5jb250ZXh0LmZpbGxTdHlsZSA9ICJyZ2JhKDAsMjU1LDI1NSwgMC40KSIKICAgIH0sCiAgICBjbGljayhlKSB7CiAgICAgIHZhciB4ID0gZS5jbGllbnRYIC0gdGhpcy5yZWN0LmxlZnQKICAgICAgdmFyIHkgPSBlLmNsaWVudFkgLSB0aGlzLnJlY3QudG9wCiAgICAgIGlmICghdGhpcy5pc0RyYXdpbmcpIHsKICAgICAgICBpZiAodGhpcy5pbnNpZGUoW3gsIHldLCB0aGlzLmFycikgIT0gLTEpIHsKICAgICAgICAgIHRoaXMuY2hvc2VPbGRBcmVhID0gMQogICAgICAgICAgdGhpcy5jaG9zZUFyZWEodGhpcy5pbnNpZGUoW3gsIHldLCB0aGlzLmFyciksIHRoaXMuYXJyKQogICAgICAgIH0KICAgICAgICBpZiAodGhpcy5pbnNpZGUoW3gsIHldLCB0aGlzLm9sZF9hcnIpICE9IC0xKSB7CiAgICAgICAgICB0aGlzLmNob3NlT2xkQXJlYSA9IDIKICAgICAgICAgIHRoaXMuY2hvc2VBcmVhKHRoaXMuaW5zaWRlKFt4LCB5XSwgdGhpcy5vbGRfYXJyKSwgdGhpcy5vbGRfYXJyKQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnBvaW50cy5wdXNoKFt4LCB5XSkKICAgICAgICBpZiAodGhpcy5pID09IDApIHsKICAgICAgICAgIHRoaXMuY29udGV4dC5iZWdpblBhdGgoKTsKICAgICAgICAgIHRoaXMuY29udGV4dC5tb3ZlVG8oeCwgeSk7CiAgICAgICAgfQogICAgICAgIGlmICh0aGlzLmkgPiAwKSB7CiAgICAgICAgICB0aGlzLmNvbnRleHQubGluZVRvKHgsIHkpOwogICAgICAgICAgdGhpcy5jb250ZXh0LnN0cm9rZSgpOwogICAgICAgICAgaWYgKE1hdGguYWJzKHggLSB0aGlzLnBvaW50c1swXVswXSkgPCAxMCAmJiBNYXRoLmFicyh5IC0gdGhpcy5wb2ludHNbMF1bMV0pIDwgMTAgJiYgdGhpcy5pPj0yKSB7CiAgICAgICAgICAgIC8vIGFsZXJ0KCdjbG9zZUFyZWEnKQogICAgICAgICAgICAvLyB0aGlzLnBvaW50cy5wb3AoKQogICAgICAgICAgICB0aGlzLmNsb3NlQXJlYSgpCiAgICAgICAgICAgIHJldHVybiAwCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHRoaXMuaSsrCiAgICAgIH0KICAgIH0sCiAgICBkcmF3RnJvbUFycmF5KGFycikgewogICAgICB2YXIgcG9pbnRzCiAgICAgIHZhciBmaWxsQ29sb3IgPSB0aGlzLmNvbnRleHQuZmlsbFN0eWxlLnNwbGl0KCcsJykKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHsKICAgICAgICBpZiAoYXJyW2ldLnN0YXR1cyl7CiAgICAgICAgICAvLyBmaWxsQ29sb3JbM10gPSBhcnJbaV0uc3RhdHVzICsnKScKICAgICAgICAgIC8vIGZpbGxDb2xvciA9IGZpbGxDb2xvclswXSsiLCIrZmlsbENvbG9yWzFdKyIsIitmaWxsQ29sb3JbMl0rIiwiK2ZpbGxDb2xvclszXQogICAgICAgICAgLy8gdGhpcy5jb250ZXh0LmZpbGxTdHlsZQogICAgICAgICAgICAgIHRoaXMuY29udGV4dC5zdHJva2VUZXh0KGFycltpXS5zdGF0dXMsIGFycltpXS54LCBhcnJbaV0ueSkKICAgICAgICAgIC8vIHRoaXMuY29udGV4dC5maWxsU3R5bGUgPSAicmdiYSgwLDEwNiwyNTUsIDAuMykiCiAgICAgICAgfQogICAgICAgIHBvaW50cyA9IGFycltpXS5kb3RzCiAgICAgICAgdGhpcy5jb250ZXh0LmJlZ2luUGF0aCgpCiAgICAgICAgdGhpcy5jb250ZXh0Lm1vdmVUbyhwb2ludHNbMF1bMF0sIHBvaW50c1swXVsxXSk7CiAgICAgICAgZm9yICh2YXIgaiA9IDE7IGogPCBwb2ludHMubGVuZ3RoOyBqKyspIHsKICAgICAgICAgIHZhciB4ID0gcG9pbnRzW2pdWzBdCiAgICAgICAgICB2YXIgeSA9IHBvaW50c1tqXVsxXQogICAgICAgICAgdGhpcy5jb250ZXh0LmxpbmVUbyh4LCB5KTsKICAgICAgICB9CiAgICAgICAgdGhpcy5jb250ZXh0LmNsb3NlUGF0aCgpCiAgICAgICAgdGhpcy5jb250ZXh0LmZpbGwoKTsKICAgICAgICB0aGlzLmNvbnRleHQuc3Ryb2tlKCk7CiAgICAgIH0KICAgIH0sCiAgICBhc3luYyBhZGRDb250cm9sbGVyKGFycikgewogICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7bmFtZTogJ2FkZENvbnRyb2xsZXInLCBwYXJhbXM6IHthcnI6IHRoaXMuYXJyUHhUb1Byb2MoYXJyKSwgaWQ6IHRoaXMuaWR9fSkKICAgIH0sCiAgICBweFRvUHJvY2VudCh4LCB5KSB7CiAgICAgIHJldHVybiBbTWF0aC5yb3VuZCgoeCAvIHRoaXMucmVjdC53aWR0aCkgKiAxMDApLCBNYXRoLnJvdW5kKCh5IC8gdGhpcy5yZWN0LmhlaWdodCkgKiAxMDApXQogICAgfSwKICAgIHByb2NlbnRUb1B4KHgsIHkpIHsKICAgICAgcmV0dXJuIFt4ICogdGhpcy5yZWN0LndpZHRoIC8gMTAwLHkgKiB0aGlzLnJlY3QuaGVpZ2h0IC8gMTAwXQogICAgfSwKICAgIGluc2lkZShwb2ludCwgdnMpIHsKICAgICAgdmFyIHggPSBwb2ludFswXSwgeSA9IHBvaW50WzFdOwogICAgICB2YXIgaW5zaWRlID0gZmFsc2UsIHBvaW50cyA9IFtdCiAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgdnMubGVuZ3RoOyBrKyspIHsKICAgICAgICBwb2ludHMgPSB2c1trXS5kb3RzCiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGogPSBwb2ludHMubGVuZ3RoIC0gMTsgaSA8IHBvaW50cy5sZW5ndGg7IGogPSBpKyspIHsKICAgICAgICAgIHZhciB4aSA9IHBvaW50c1tpXVswXSwgeWkgPSBwb2ludHNbaV1bMV07CiAgICAgICAgICB2YXIgeGogPSBwb2ludHNbal1bMF0sIHlqID0gcG9pbnRzW2pdWzFdOwoKICAgICAgICAgIHZhciBpbnRlcnNlY3QgPSAoKHlpID4geSkgIT0gKHlqID4geSkpCiAgICAgICAgICAgICAgJiYgKHggPCAoeGogLSB4aSkgKiAoeSAtIHlpKSAvICh5aiAtIHlpKSArIHhpKTsKICAgICAgICAgIGlmIChpbnRlcnNlY3QpIGluc2lkZSA9ICFpbnNpZGU7CiAgICAgICAgfQogICAgICAgIGlmIChpbnNpZGUpIHsKICAgICAgICAgIHJldHVybiBrCiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiAtMQogICAgfSwKICAgIGFyclB4VG9Qcm9jKGFycikgewogICAgICBjb25zb2xlLmxvZyhhcnIubGVuZ3RoKQogICAgICB2YXIgcG9pbnRzLCBhcnIxID0gW10sIHBvaW50czIgPSBbXSwgZG90CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgcG9pbnRzID0gYXJyW2ldLmRvdHMKICAgICAgICBjb25zb2xlLmxvZyhwb2ludHMsIHBvaW50cy5sZW5ndGgpCiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBwb2ludHMubGVuZ3RoOyBqKyspIHsKICAgICAgICAgIGRvdCA9IHRoaXMucHhUb1Byb2NlbnQocG9pbnRzW2pdWzBdLCBwb2ludHNbal1bMV0pCiAgICAgICAgICBwb2ludHMyLnB1c2goZG90KQogICAgICAgIH0KICAgICAgICBhcnIxLnB1c2goeydpZCc6IGksICdkb3RzJzogcG9pbnRzMn0pCiAgICAgICAgcG9pbnRzMiA9IFtdCiAgICAgIH0KICAgICAgcmV0dXJuIGFycjEKICAgIH0sCiAgICBhc3luYyBkcmF3T2xkQXJlYXMoKXsKICAgICAgdHJ5IHsKICAgICAgICB0aGlzLmNvbnRleHQuc3Ryb2tlU3R5bGUgPSAicmdiYSgwLDMwLDE1MCwgMC42KSIKICAgICAgICB0aGlzLmNvbnRleHQuZmlsbFN0eWxlID0gInJnYmEoMCwxMDYsMjU1LCAwLjMpIgogICAgICAgIHZhciByZXNwb25zZSA9IGF3YWl0IGF4aW9zLmdldCgnL2FwaS9hcmVhcycpOwogICAgICAgIHJlc3BvbnNlID0gcmVzcG9uc2UuZGF0YQogICAgICAgIHZhciBjb29yZCwgc3RhdHVzOwogICAgICAgIGZvciAodmFyIGk9MDsgaTxyZXNwb25zZS5sZW5ndGg7IGkrKykgewogICAgICAgICAgaWYgKHRoaXMuaWQgPT0gcmVzcG9uc2VbaV0uY2FtZXJhX2lkKSB7CiAgICAgICAgICAgIHZhciBtYXhYPTAuMCwgbWluWD10aGlzLnJlY3Qud2lkdGgsIG1heFk9MC4wLCBtaW5ZPXRoaXMucmVjdC5oZWlnaHQKICAgICAgICAgICAgY29vcmQgPSByZXNwb25zZVtpXS5jb29yZGluYXRlcwogICAgICAgICAgICBzdGF0dXMgPSAoKGF3YWl0IGF4aW9zLmdldCgnL2FwaS9jb250cm9sbGVycycpKS5kYXRhLmZpbmQoY29udHJvbGxlciA9PiBjb250cm9sbGVyLmlkID09PSByZXNwb25zZVtpXS5jb250cm9sbGVyc1swXSkpLnN0YXR1cwogICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGNvb3JkLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgY29vcmRbal0gPSAodGhpcy5wcm9jZW50VG9QeChjb29yZFtqXVswXSwgY29vcmRbal1bMV0pKQogICAgICAgICAgICAgIG1pblggPSBNYXRoLm1pbihtaW5YLCBjb29yZFtqXVswXSkKICAgICAgICAgICAgICBtYXhYID0gTWF0aC5tYXgobWF4WCwgY29vcmRbal1bMF0pCiAgICAgICAgICAgICAgbWluWSA9IE1hdGgubWluKG1pblksIGNvb3JkW2pdWzFdKQogICAgICAgICAgICAgIG1heFkgPSBNYXRoLm1heChtYXhZLCBjb29yZFtqXVsxXSkKICAgICAgICAgICAgfQogICAgICAgICAgICBjb25zb2xlLmxvZyhpLCBtaW5YLCBtYXhYLCBtaW5ZLCBtYXhZKQogICAgICAgICAgICAvLyB0aGlzLmNvbnRleHQuc3Ryb2tlVGV4dChzdGF0dXMsIChtYXhYK21pblgpLzIsIChtYXhZK21pblkpLzIpCiAgICAgICAgICAgIGNvb3JkID0ge2lkOiByZXNwb25zZVtpXS5pZCwgZG90czogY29vcmQsIHN0YXR1czogc3RhdHVzLCB4OigobWF4WCttaW5YKS8yKSwgeTooKG1heFkrbWluWSkvMil9CiAgICAgICAgICAgIHRoaXMub2xkX2Fyci5wdXNoKGNvb3JkKQogICAgICAgICAgICBjb29yZCA9IFtjb29yZF0KICAgICAgICAgICAgdGhpcy5kcmF3RnJvbUFycmF5KGNvb3JkKQogICAgICAgICAgICBjb29yZCA9IG51bGwKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHRoaXMuY29udGV4dC5zdHJva2VTdHlsZSA9ICJyZ2IoMCw3MCwxNjApIgogICAgICAgIHRoaXMuY29udGV4dC5maWxsU3R5bGUgPSAicmdiYSgwLDI1NSwyNTUsMC40KSIKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTsKICAgICAgfQogICAgfQogIH0KfQo="},{"version":3,"sources":["CameraPage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsCA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"CameraPage.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div id=\"cameraPage\"><b-row class=\"m-0\">\n    <b-col cols=\"8\">\n      <h2>Камера {{ id }}</h2>\n    </b-col>\n    <b-col class=\"float-right\">\n\n    <div v-if=\"chosenArea==-1\">\n          <div v-if=\"!isDrawing\">\n            <b-button v-on:click=\"isDrawing = 'true'\" variant=\"secondary\" class=\"mx-2\">Создать область</b-button>\n            <b-button v-if=\"arr.length\" v-on:click=\"addController(arr)\" class=\"mx-2\" variant=\"secondary\">Прикрепить\n            </b-button>\n          </div>\n          <div v-else>\n            <b-button v-if=\"i>2\" v-on:click=\"closeArea\" variant=\"dark\" class=\"mx-2\">Замкнуть область</b-button>\n            <b-button v-on:click=\"delDrawingArea\" variant=\"dark\" class=\"mx-2\">Отменить</b-button>\n          </div>\n        </div>\n        <div v-else>\n          <b-button v-on:click=\"deleteArea(chosenArea)\" variant=\"dark\" class=\"mx-2\">Удалить выбранную область</b-button>\n        </div>\n    </b-col>\n  </b-row>\n\n    <div class=\"canvases\">\n<!--      <img class=\"myCanvas\" style=\"z-index: 10\" :src=\"'/cameras/'+id\">-->\n      <img class=\"myCanvas\" style=\"z-index: 10\" :src=\"'/api/camera/'+id+'/capture'\">\n      <canvas ref=\"canvas\" id='drawing-pad' width='1280' height=\"640\" style=\"z-index: 100; border: 2px solid black\"\n              class=\"myCanvas\">\n        This is an interactive drawing pad.\n      </canvas>\n    </div>\n\n  </div>\n</template>\n\n\n<script>\nimport axios from \"axios\";\n\nexport default {\n  name: 'CameraPage',\n  props: ['id'],\n  data: () => ({\n    points: [],\n    area_id: 0,\n    i: 0,\n    arr: [],\n    old_arr: [],\n    x: null, y: null,\n    canvas: null,\n    context: null,\n    isDrawing: false,\n    chosenArea: -1,\n    rect: null,\n    choseOldArea: -1,\n  }),\n  mounted() {\n    this.canvas = this.$refs.canvas\n    this.context = this.canvas.getContext(\"2d\"); //ctx\n    this.context.lineWidth = 2;\n    this.context.font = \"20px Georgia\";\n    this.context.strokeStyle = \"rgb(0,70,160)\"\n    this.context.fillStyle = \"rgba(0,255,255,0.4)\"\n    this.rect = this.canvas.getBoundingClientRect()\n    this.canvas.addEventListener('click', this.click)\n    this.drawOldAreas()\n    // this.drawFromServer()\n  },\n  methods: {\n    closeArea: function () {\n      var area = {\"id\": this.area_id, \"dots\": this.points}\n      console.log(this.points)\n      this.area_id++;\n      this.arr.push(area)\n      // this.writeAreasToFile()\n      this.points = []\n      this.i = 0\n      this.x = null\n      this.y = null\n      this.context.closePath()\n      this.context.fill();\n      this.context.stroke();\n      this.isDrawing = false;\n    },\n    choseArea(id) {\n      this.context.clearRect(0, 0, this.rect.width, this.rect.height)\n      this.drawFromArray(this.arr)\n      this.context.strokeStyle = \"rgba(0,30,150, 0.6)\"\n      this.context.fillStyle = \"rgba(0,106,255, 0.3)\"\n      this.drawFromArray(this.old_arr)\n      this.context.strokeStyle = \"rgb(0,70,160)\"\n      this.context.fillStyle = \"rgba(0,255,255, 0.4)\"\n      this.chosenArea = id\n      if (this.choseOldArea == 1) {\n        var points = this.arr[id].dots\n      }\n      else if (this.choseOldArea == 2){\n        var points = this.old_arr[id].dots\n      }\n      this.context.beginPath();\n      this.context.moveTo(points[0][0], points[0][1]);\n      for (var i = 0; i < points.length; i++) {\n        this.context.lineTo(points[i][0], points[i][1])\n      }\n      this.context.closePath()\n      this.context.strokeStyle = \"red\"\n      this.context.fillStyle = \"rgba(255,0,170, 0.4)\"\n      this.context.fill();\n      this.context.stroke();\n      this.context.strokeStyle = \"rgb(0,70,160)\"\n      this.context.fillStyle = \"rgba(0,255,255,0.4)\"\n    },\n    deleteArea(id) {\n      if (this.choseOldArea == 1){\n        this.arr.splice(id, 1)\n      }\n      else {\n        var ar_id = this.old_arr[id].id\n        // console.log(id)\n        axios.delete(`/api/areas/${ar_id}`)\n            .then(response => (console.log(response)));\n        this.old_arr.splice(id, 1)\n      }\n      this.context.clearRect(0, 0, this.rect.width, this.rect.height)\n      this.drawFromArray(this.arr)\n      this.context.strokeStyle = \"rgba(0,30,150, 0.6)\"\n      this.context.fillStyle = \"rgba(0,106,255, 0.3)\"\n      this.drawFromArray(this.old_arr)\n\n      this.context.strokeStyle = \"rgb(0,70,160)\"\n      this.context.fillStyle = \"rgba(0,255,255, 0.4)\"\n      this.chosenArea = -1\n      this.choseOldArea = -1\n    },\n    delDrawingArea() {\n      this.points = []\n      this.i = 0\n      this.x = null\n      this.y = null\n      this.isDrawing = false\n\n      this.context.clearRect(0, 0, this.rect.width, this.rect.height)\n      this.drawFromArray(this.arr)\n      this.context.strokeStyle = \"rgba(0,30,150, 0.6)\"\n      this.context.fillStyle = \"rgba(0,106,255, 0.3)\"\n      this.drawFromArray(this.old_arr)\n\n      this.context.strokeStyle = \"rgb(0,70,160)\"\n      this.context.fillStyle = \"rgba(0,255,255, 0.4)\"\n    },\n    click(e) {\n      var x = e.clientX - this.rect.left\n      var y = e.clientY - this.rect.top\n      if (!this.isDrawing) {\n        if (this.inside([x, y], this.arr) != -1) {\n          this.choseOldArea = 1\n          this.choseArea(this.inside([x, y], this.arr), this.arr)\n        }\n        if (this.inside([x, y], this.old_arr) != -1) {\n          this.choseOldArea = 2\n          this.choseArea(this.inside([x, y], this.old_arr), this.old_arr)\n        }\n      } else {\n        this.points.push([x, y])\n        if (this.i == 0) {\n          this.context.beginPath();\n          this.context.moveTo(x, y);\n        }\n        if (this.i > 0) {\n          this.context.lineTo(x, y);\n          this.context.stroke();\n          if (Math.abs(x - this.points[0][0]) < 10 && Math.abs(y - this.points[0][1]) < 10 && this.i>=2) {\n            // alert('closeArea')\n            // this.points.pop()\n            this.closeArea()\n            return 0\n          }\n        }\n        this.i++\n      }\n    },\n    drawFromArray(arr) {\n      var points\n      var fillColor = this.context.fillStyle.split(',')\n      for (var i = 0; i < arr.length; i++) {\n        if (arr[i].status){\n          // fillColor[3] = arr[i].status +')'\n          // fillColor = fillColor[0]+\",\"+fillColor[1]+\",\"+fillColor[2]+\",\"+fillColor[3]\n          // this.context.fillStyle\n              this.context.strokeText(arr[i].status, arr[i].x, arr[i].y)\n          // this.context.fillStyle = \"rgba(0,106,255, 0.3)\"\n        }\n        points = arr[i].dots\n        this.context.beginPath()\n        this.context.moveTo(points[0][0], points[0][1]);\n        for (var j = 1; j < points.length; j++) {\n          var x = points[j][0]\n          var y = points[j][1]\n          this.context.lineTo(x, y);\n        }\n        this.context.closePath()\n        this.context.fill();\n        this.context.stroke();\n      }\n    },\n    async addController(arr) {\n      this.$router.push({name: 'addController', params: {arr: this.arrPxToProc(arr), id: this.id}})\n    },\n    pxToProcent(x, y) {\n      return [Math.round((x / this.rect.width) * 100), Math.round((y / this.rect.height) * 100)]\n    },\n    procentToPx(x, y) {\n      return [x * this.rect.width / 100,y * this.rect.height / 100]\n    },\n    inside(point, vs) {\n      var x = point[0], y = point[1];\n      var inside = false, points = []\n      for (var k = 0; k < vs.length; k++) {\n        points = vs[k].dots\n        for (var i = 0, j = points.length - 1; i < points.length; j = i++) {\n          var xi = points[i][0], yi = points[i][1];\n          var xj = points[j][0], yj = points[j][1];\n\n          var intersect = ((yi > y) != (yj > y))\n              && (x < (xj - xi) * (y - yi) / (yj - yi) + xi);\n          if (intersect) inside = !inside;\n        }\n        if (inside) {\n          return k\n        }\n      }\n      return -1\n    },\n    arrPxToProc(arr) {\n      console.log(arr.length)\n      var points, arr1 = [], points2 = [], dot\n      for (var i = 0; i < arr.length; i++) {\n        points = arr[i].dots\n        console.log(points, points.length)\n        for (var j = 0; j < points.length; j++) {\n          dot = this.pxToProcent(points[j][0], points[j][1])\n          points2.push(dot)\n        }\n        arr1.push({'id': i, 'dots': points2})\n        points2 = []\n      }\n      return arr1\n    },\n    async drawOldAreas(){\n      try {\n        this.context.strokeStyle = \"rgba(0,30,150, 0.6)\"\n        this.context.fillStyle = \"rgba(0,106,255, 0.3)\"\n        var response = await axios.get('/api/areas');\n        response = response.data\n        var coord, status;\n        for (var i=0; i<response.length; i++) {\n          if (this.id == response[i].camera_id) {\n            var maxX=0.0, minX=this.rect.width, maxY=0.0, minY=this.rect.height\n            coord = response[i].coordinates\n            status = ((await axios.get('/api/controllers')).data.find(controller => controller.id === response[i].controllers[0])).status\n            for (var j = 0; j < coord.length; j++) {\n              coord[j] = (this.procentToPx(coord[j][0], coord[j][1]))\n              minX = Math.min(minX, coord[j][0])\n              maxX = Math.max(maxX, coord[j][0])\n              minY = Math.min(minY, coord[j][1])\n              maxY = Math.max(maxY, coord[j][1])\n            }\n            console.log(i, minX, maxX, minY, maxY)\n            // this.context.strokeText(status, (maxX+minX)/2, (maxY+minY)/2)\n            coord = {id: response[i].id, dots: coord, status: status, x:((maxX+minX)/2), y:((maxY+minY)/2)}\n            this.old_arr.push(coord)\n            coord = [coord]\n            this.drawFromArray(coord)\n            coord = null\n          }\n        }\n\n        this.context.strokeStyle = \"rgb(0,70,160)\"\n        this.context.fillStyle = \"rgba(0,255,255,0.4)\"\n      } catch (error) {\n        console.error(error);\n      }\n    }\n  }\n}\n</script>\n\n<style>\nbody {\n  margin: 0;\n}\n\n.canvases {\n  position: relative;\n}\n\n.myCanvas {\n  position: absolute;\n  width: 1280px;\n  height: 640px;\n  top: 0px\n}\n</style>"]}]}