{"remainingRequest":"/home/aigul/projects/rtsp_stream_v2/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/aigul/projects/rtsp_stream_v2/src/views/addController.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/aigul/projects/rtsp_stream_v2/src/views/addController.vue","mtime":1614288206645},{"path":"/home/aigul/projects/rtsp_stream_v2/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/aigul/projects/rtsp_stream_v2/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBjb250cm9sbGVycyBmcm9tICJAL3ZpZXdzL2NvbnRyb2xsZXJzIjsKaW1wb3J0IGF4aW9zIGZyb20gImF4aW9zIjsKZXhwb3J0IGRlZmF1bHQgewpuYW1lOiAiYWRkQ29udHJvbGxlci52dWUiLAogIHByb3BzOiBbJ2FycicsICdpZCddLAogIGNvbXBvbmVudHM6IHsKICAgIGNvbnRyb2xsZXJzCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgY29udHJvbGxlcnM6IFtdLAogICAgICBzZWxlY3RlZERldmljZXM6IFtdLAogICAgICBjb2x1bW5zOiBbCiAgICAgICAge2tleTogJ2lkJywgbGFiZWw6ICdJRCd9LAogICAgICAgIHtrZXk6ICdidXR0b24xJywgbGFiZWw6ICfQn9C+0LTQsNGC0Ywg0YHQuNCz0L3QsNC7J30sCiAgICAgICAge2tleTogJ2J1dHRvbjInLCBsYWJlbDogJ9CS0YvQsdGA0LDRgtGMJ30sCiAgICAgIF0sCiAgICAgIGdyb3VwQWxlcnQ6IGZhbHNlLAogICAgfQogIH0sCiAgbW91bnRlZCgpIHsKICAgIHRoaXMuZ2V0RnJlZURldmljZXMoKQogIH0sCiAgbWV0aG9kczogewogICAgZ2V0RnJlZURldmljZXMoKSB7CiAgICAgIGF4aW9zLmdldCgnaHR0cDovLzE5Mi4xNjguMS4xMDQ6NTAwMC9hcGkvY29udHJvbGxlcnMvc2NhbicsIHsKICAgICAgICBoZWFkZXJzOiB7IkFjY2Vzcy1Db250cm9sLUFsbG93LU9yaWdpbiI6ICIqIn0KICAgICAgfSkKICAgICAgICAgIC50aGVuKHJlc3BvbnNlID0+ICh0aGlzLmNvbnRyb2xsZXJzID0gcmVzcG9uc2UuZGF0YSkpOwogICAgfSwKICAgIGFzeW5jIGNob29zZURldml2ZShpZCkgewogICAgICBjb25zb2xlLmxvZygnY2hvb3NpbmcgJyArIGlkKTsKICAgICAgdGhpcy5zZWxlY3RlZERldmljZXMucHVzaCh0aGlzLmNvbnRyb2xsZXJzW2lkXSkKICAgICAgdGhpcy5jb250cm9sbGVycy5zcGxpY2UoaWQsIDEpCiAgICB9LAogICAgYXN5bmMgZGVsZXRlRGV2aXZlKGlkLCBjaWQpIHsKICAgICAgY29uc29sZS5sb2coJ2RlbGV0aW5nICcgKyBpZCk7CiAgICAgIHRoaXMuY29udHJvbGxlcnMucHVzaCh0aGlzLnNlbGVjdGVkRGV2aWNlc1tpZF0pCiAgICAgIHRoaXMucmVtb3ZlQnlBdHRyKHRoaXMuc2VsZWN0ZWREZXZpY2VzLCAnY2lkJywgY2lkKQogICAgfSwKICAgIGFzeW5jIHJlbW92ZUJ5QXR0cihhcnIsIGF0dHIsIHZhbHVlKXsKICAgICAgdmFyIGkgPSBhcnIubGVuZ3RoOwogICAgICB3aGlsZShpLS0pewogICAgICAgIGlmKCBhcnJbaV0KICAgICAgICAgICAgJiYgYXJyW2ldLmhhc093blByb3BlcnR5KGF0dHIpCiAgICAgICAgICAgICYmIChhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcnJbaV1bYXR0cl0gPT09IHZhbHVlICkgKXsKICAgICAgICAgIGFyci5zcGxpY2UoaSwxKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIGFycjsKICAgIH0sCiAgICBibGluayhpZCkgewogICAgICBjb25zb2xlLmxvZygnYmxpbmsgJyArIGlkKQogICAgICBsZXQgZGF0YSA9IHsKICAgICAgICBpZDogaWQKICAgICAgfQogICAgICBmZXRjaChgL2JsaW5rYCwKICAgICAgICAgIHsKICAgICAgICAgICAgbWV0aG9kOiAiUE9TVCIsCiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGRhdGEpLAogICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJywKICAgICAgICAgICAgICAnQWNjZXB0JzogJ2FwcGxpY2F0aW9uL2pzb24nLAogICAgICAgICAgICAgICdpZCc6IGlkLAogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICkKICAgIH0sCiAgICBhc3luYyBhZGRDb250cm9sbGVyKGFyciwgZGV2aWNlcyl7CiAgICAgIHZhciBhcmVhID0gW10KICAgICAgZm9yICh2YXIgaT0wOyBpPGRldmljZXMubGVuZ3RoOyBpKyspewogICAgICAgIGZvciAodmFyIGo9MDsgajxhcnIubGVuZ3RoOyBqKyspewogICAgICAgICAgZm9yICh2YXIgaz0wO2s8YXJyW2pdLmRvdHMubGVuZ3RoOyBrKyspewogICAgICAgICAgICBhcmVhLnB1c2goW2FycltqXS5kb3RzW2tdWzBdLGFycltqXS5kb3RzW2tdWzFdXSkKICAgICAgICAgIH0KICAgICAgICAgIGNvbnNvbGUubG9nKGFyZWEpCiAgICAgICAgICBheGlvcy5wb3N0KCdodHRwOi8vMTkyLjE2OC4xLjEwNDo1MDAwL2FwaS9hcmVhcycsIHsKICAgICAgICAgICAgY29udHJvbGxlcnM6IGRldmljZXNbaV0uaWQsCiAgICAgICAgICAgIGNhbWVyYV9pZDogdGhpcy5pZCwKICAgICAgICAgICAgY29vcmRpbmF0ZXM6IGFyZWEKICAgICAgICAgIH0pCiAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7CiAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICBhcmVhID0gW10KICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgfQp9Cg=="},{"version":3,"sources":["addController.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"addController.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"addController\">\n    <div>\n      <b-row class=\"p-2\">\n        <b-col>\n            <h5>Доступные устройства ({{ controllers.length }})</h5>\n            <div class=\"p-2\">\n              <b-table responsive fixed :items=\"controllers\" :fields=\"columns\" table-variant=\"secondary\">\n                <template #cell(button1)=\"row\">\n                  <b-button size=\"sm\" class=\"mr-2\" @click=\"blink(row.item.id)\">\n                    Сигнал\n                  </b-button>\n                </template>\n                <template #cell(button2)=\"row\">\n                  <b-button size=\"sm\" @click=\"chooseDevive(row.index)\" class=\"mr-2\">\n                    Добавить\n                  </b-button>\n                </template>\n              </b-table>\n            </div>\n        </b-col>\n        <b-col>\n          <div>\n            <h5>Выбранные устройства ({{ selectedDevices.length }})</h5>\n            <div class=\"p-2\">\n              <b-table responsive :items=\"selectedDevices\" :fields=\"columns\" table-variant=\"secondary\">\n                <template #cell(button1)=\"row\">\n                  <b-button size=\"sm\" class=\"mr-2\" @click=\"blink(row.item.id)\">\n                    Сигнал\n                  </b-button>\n                </template>\n                <template #cell(button2)=\"row\">\n                  <b-button size=\"sm\" @click=\"deleteDevive(row.index, row.item.id)\" class=\"mr-2\">\n                    Удалить\n                  </b-button>\n                </template>\n              </b-table>\n            </div>\n          </div>\n        </b-col>\n      </b-row>\n    </div>\n\n\n    <div class=\"my-3\">\n      <b-card class=\"bg-sec\">\n        <div class=\"text-center mt-2\">\n          <b-button variant=\"dark\" @click=\"addController(arr, selectedDevices)\">Прикрепить к {{arr.length}} областям</b-button>\n        </div>\n      </b-card>\n<!--      <div v-if=\"groupAlert\" class=\"fixed-top w-100 h-100\" style=\"z-index: 5; background-color: rgba(0,0,0,0.7)\" />-->\n<!--      <b-alert-->\n<!--          dismissible-->\n<!--          v-model=\"groupAlert\"-->\n<!--          variant=\"dark\"-->\n<!--          class=\"position-fixed\"-->\n<!--          style=\"top: 10vh; left: 10vw; width: 80vw; height: 80vh; z-index: 10; padding: 5%;\"-->\n<!--      >-->\n<!--        <div class=\"my-3\">-->\n<!--          <h3>Создание группы</h3>-->\n<!--          <div class=\"px-2\">-->\n<!--            <h5>Выбранные устройства: </h5>-->\n<!--            <div class=\"text-center mt-4\">-->\n<!--              <b-button variant=\"dark\" @click=\"createGroup()\">Создать группу</b-button>-->\n<!--            </div>-->\n<!--          </div>-->\n<!--        </div>-->\n<!--      </b-alert>-->\n    </div>\n  </div>\n</template>\n\n<script>\nimport controllers from \"@/views/controllers\";\nimport axios from \"axios\";\nexport default {\nname: \"addController.vue\",\n  props: ['arr', 'id'],\n  components: {\n    controllers\n  },\n  data() {\n    return {\n      controllers: [],\n      selectedDevices: [],\n      columns: [\n        {key: 'id', label: 'ID'},\n        {key: 'button1', label: 'Подать сигнал'},\n        {key: 'button2', label: 'Выбрать'},\n      ],\n      groupAlert: false,\n    }\n  },\n  mounted() {\n    this.getFreeDevices()\n  },\n  methods: {\n    getFreeDevices() {\n      axios.get('http://192.168.1.104:5000/api/controllers/scan', {\n        headers: {\"Access-Control-Allow-Origin\": \"*\"}\n      })\n          .then(response => (this.controllers = response.data));\n    },\n    async chooseDevive(id) {\n      console.log('choosing ' + id);\n      this.selectedDevices.push(this.controllers[id])\n      this.controllers.splice(id, 1)\n    },\n    async deleteDevive(id, cid) {\n      console.log('deleting ' + id);\n      this.controllers.push(this.selectedDevices[id])\n      this.removeByAttr(this.selectedDevices, 'cid', cid)\n    },\n    async removeByAttr(arr, attr, value){\n      var i = arr.length;\n      while(i--){\n        if( arr[i]\n            && arr[i].hasOwnProperty(attr)\n            && (arguments.length > 2 && arr[i][attr] === value ) ){\n          arr.splice(i,1);\n        }\n      }\n      return arr;\n    },\n    blink(id) {\n      console.log('blink ' + id)\n      let data = {\n        id: id\n      }\n      fetch(`/blink`,\n          {\n            method: \"POST\",\n            body: JSON.stringify(data),\n            headers: {\n              'Content-Type': 'application/json',\n              'Accept': 'application/json',\n              'id': id,\n            }\n          }\n      )\n    },\n    async addController(arr, devices){\n      var area = []\n      for (var i=0; i<devices.length; i++){\n        for (var j=0; j<arr.length; j++){\n          for (var k=0;k<arr[j].dots.length; k++){\n            area.push([arr[j].dots[k][0],arr[j].dots[k][1]])\n          }\n          console.log(area)\n          axios.post('http://192.168.1.104:5000/api/areas', {\n            controllers: devices[i].id,\n            camera_id: this.id,\n            coordinates: area\n          })\n              .then(function (response) {\n                console.log(response);\n              })\n              .catch(function (error) {\n                console.log(error);\n              });\n          area = []\n        }\n      }\n    },\n  }\n}\n</script>"]}]}