{"remainingRequest":"/home/aigul/projects/rtsp_stream_v2/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/aigul/projects/rtsp_stream_v2/src/App.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/aigul/projects/rtsp_stream_v2/src/App.vue","mtime":1613354900272},{"path":"/home/aigul/projects/rtsp_stream_v2/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/aigul/projects/rtsp_stream_v2/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBKU01wZWcgZnJvbSAnanNtcGVnLXBsYXllcicKY29uc3QgZnMgPSByZXF1aXJlKCJicm93c2VyaWZ5LWZzIik7CmNvbnN0IGFyZWFfZmlsZSA9IHJlcXVpcmUoJy4uL3B1YmxpYy9kYXRhLmpzb24nKTsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnQXBwJywKICBjb21wb25lbnRzOiB7fSwKICBkYXRhOiAoKSA9PiAoewogICAgcG9pbnRzOiBbXSwKICAgIGFyZWFfaWQ6IDAsCiAgICBpOiAwLAogICAgYXJyOiBbXSwKICAgIHg6IG51bGwsIHk6IG51bGwsCiAgICBjYW52YXM6IG51bGwsCiAgICBjb250ZXh0OiBudWxsLAogICAgaXNEcmF3aW5nOiBmYWxzZSwKICB9KSwKICBtb3VudGVkKCkgewogICAgbGV0IGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2aWRlb0NhbnZhcycpOwogICAgbGV0IHVybCA9ICd3czovLzE5Mi4xNjguMS4xMDA6NTAwMCc7CiAgICBsZXQgcGxheWVyID0gbmV3IEpTTXBlZy5QbGF5ZXIodXJsLCB7CiAgICAgIGNhbnZhczogY2FudmFzLAogICAgICBhdXRvcGxheTogdHJ1ZSwgYXVkaW86IGZhbHNlLCBsb29wOiB0cnVlLAogICAgICBvblZpZGVvRGVjb2RlOiAoKSA9PiB7CiAgICAgIH0KICAgIH0pCgogICAgdGhpcy5jYW52YXMgPSB0aGlzLiRyZWZzLmNhbnZhcwogICAgdGhpcy5jb250ZXh0ID0gdGhpcy5jYW52YXMuZ2V0Q29udGV4dCgiMmQiKTsKICAgIHRoaXMuY29udGV4dC5saW5lV2lkdGggPSAyOwogICAgdGhpcy5jb250ZXh0LnN0cm9rZVN0eWxlID0gInJlZCI7CiAgICB0aGlzLmNvbnRleHQuZmlsbFN0eWxlID0gInJnYmEoMCwyNTUsMjU1LDAuNCkiCiAgICB0aGlzLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuY2xpY2spCiAgICB0aGlzLmRyYXdGcm9tRmlsZSgpCiAgfSwKICBtZXRob2RzOiB7CiAgICBuZXdBcmVhKCkgewogICAgICAvLyBhbGVydCgi0KHQvtC30LTQsNC90LjQtSDQvdC+0LLQvtC5INC+0LHQu9Cw0YHRgtC4IikKICAgICAgdGhpcy5pc0RyYXdpbmcgPSB0cnVlOwogICAgfSwKICAgIGNsb3NlQXJlYTogZnVuY3Rpb24gKCkgewogICAgICB0aGlzLmlzRHJhd2luZyA9IGZhbHNlOwogICAgICB2YXIgYXJlYSA9IHsiaWQiOiB0aGlzLmFyZWFfaWQsICJkb3RzIjogdGhpcy5wb2ludHN9CiAgICAgIHRoaXMuYXJyLnB1c2goYXJlYSkKICAgICAgLy8gdHJ5IHsgZnMud3JpdGVGaWxlU3luYygnLi4vcHVibGljL2RhdGEuanNvbicsIEpTT04uc3RyaW5naWZ5KHRoaXMucG9pbnRzKSwgJ3V0Zi04Jyk7IH0KICAgICAgLy8gY2F0Y2goZSkgeyBhbGVydCgnRmFpbGVkIHRvIHNhdmUgdGhlIGZpbGUgIScpOyB9CiAgICAgIC8vIGZzLndyaXRlRmlsZSgnZGF0YS5qc29uJywgIEpTT04uc3RyaW5naWZ5KHRoaXMucG9pbnRzKSwgJ3V0ZjgnLCBmdW5jdGlvbihlcnIpIHsKICAgICAgLy8gICAgICAgaWYgKGVycikgdGhyb3cgZXJyOwogICAgICAvLyAgICAgICBjb25zb2xlLmxvZygnY29tcGxldGUnKTsKICAgICAgLy8gICAgIH0KICAgICAgLy8gKTsKICAgICAgLy8gbGV0IGRhdGEgPSBKU09OLnN0cmluZ2lmeSh0aGlzLnBvaW50cyk7CiAgICAgIC8vIGZzLndyaXRlRmlsZVN5bmMoIi4uL3B1YmxpYy9kYXRhLmpzb24iLCB0aGlzLnBvaW50cywgJ3V0ZjgnKTsKCgoKICAgICAgdGhpcy5wb2ludHMgPSBbXQogICAgICB0aGlzLmkgPSAwCiAgICAgIHRoaXMueCA9IDA7CiAgICAgIHRoaXMueSA9IDA7CiAgICAgIHRoaXMuY29udGV4dC5jbG9zZVBhdGgoKQogICAgICB0aGlzLmNvbnRleHQuZmlsbCgpOwogICAgICB0aGlzLmNvbnRleHQuc3Ryb2tlKCk7CiAgICAgIC8vIGFsZXJ0KCLQntCx0LvQsNGB0YLRjCDQt9Cw0LzQutC90YPRgtCwIikKICAgIH0sCiAgICBkZWxldGVBcmVhKCkgewogICAgICAvLyB0aGlzLmNhbnZhcy5jbGVhcigpCiAgICAgIC8vICDQndCj0JbQndCeINCU0J7QoNCQ0JHQntCi0JDQotCsCiAgICB9LAogICAgY2xpY2soZSkgewogICAgICBpZiAoIXRoaXMuaXNEcmF3aW5nKSB7CiAgICAgICAgdGhpcy5uZXdBcmVhKCkKICAgICAgfQogICAgICBpZiAodGhpcy5pc0RyYXdpbmcpIHsKICAgICAgICB2YXIgcmVjdCA9IHRoaXMuY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICAgIHZhciB4ID0gZS5jbGllbnRYIC0gcmVjdC5sZWZ0OwogICAgICAgIHZhciB5ID0gZS5jbGllbnRZIC0gcmVjdC50b3A7CiAgICAgICAgdGhpcy5wb2ludHMucHVzaCh7eCwgeX0pCiAgICAgICAgaWYgKHRoaXMuaSA9PSAwKSB7CiAgICAgICAgICB0aGlzLmNvbnRleHQuYmVnaW5QYXRoKCk7CiAgICAgICAgICB0aGlzLmNvbnRleHQubW92ZVRvKHgsIHkpOwogICAgICAgIH0KICAgICAgICBpZiAodGhpcy5pID4gMCkgewogICAgICAgICAgdGhpcy5jb250ZXh0LmxpbmVUbyh4LCB5KTsKICAgICAgICAgIHRoaXMuY29udGV4dC5zdHJva2UoKTsKICAgICAgICAgIGlmIChNYXRoLmFicyh4IC0gdGhpcy5wb2ludHNbMF0ueCkgPCAxMCAmJiBNYXRoLmFicyh5IC0gdGhpcy5wb2ludHNbMF0ueSkgPCAxMCkgewogICAgICAgICAgICB0aGlzLnBvaW50cy5wb3AoKQogICAgICAgICAgICB0aGlzLmNsb3NlQXJlYSgpCiAgICAgICAgICAgIHJldHVybgogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgIH0KICAgICAgdGhpcy5pKysKICAgIH0sCiAgICBkcmF3RnJvbUZpbGUoKSB7CiAgICAgIHRoaXMuYXJyLnB1c2goYXJlYV9maWxlKQogICAgICB0aGlzLmFyZWFfaWQgPSB0aGlzLmFyci5sZW5ndGgKICAgICAgdmFyIHBvaW50cwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuYXJyLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgcG9pbnRzID0gdGhpcy5hcnJbaV0uZG90cwogICAgICAgIHRoaXMuY29udGV4dC5iZWdpblBhdGgoKQogICAgICAgIHRoaXMuY29udGV4dC5tb3ZlVG8ocG9pbnRzWzBdLngsIHBvaW50c1swXS55KTsKICAgICAgICBmb3IgKHZhciBqID0gMTsgaiA8IHBvaW50cy5sZW5ndGg7IGorKykgewogICAgICAgICAgdmFyIHggPSBwb2ludHNbal0ueAogICAgICAgICAgdmFyIHkgPSBwb2ludHNbal0ueQogICAgICAgICAgdGhpcy5jb250ZXh0LmxpbmVUbyh4LCB5KTsKICAgICAgICB9CiAgICAgICAgdGhpcy5jb250ZXh0LmNsb3NlUGF0aCgpCiAgICAgICAgdGhpcy5jb250ZXh0LmZpbGwoKTsKICAgICAgICB0aGlzLmNvbnRleHQuc3Ryb2tlKCk7CiAgICAgIH0KCiAgICB9LAogIH0KfQo="},{"version":3,"sources":["App.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiCA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"App.vue","sourceRoot":"src","sourcesContent":["<template>\n  <div id=\"app\">\n    <canvas class=\"camera myCanvas\" id=\"videoCanvas\" style=\"z-index: 10\"/>\n    <div>\n      <canvas ref=\"canvas\" id='drawing-pad' width='1280' height='640' style=\"z-index: 100;\" class=\"myCanvas\">\n        This is an interactive drawing pad.\n      </canvas>\n    </div>\n\n\n    <div style=\"margin-top: 700px;\">\n      <p>\n        <strong>Координаты клика:{ {{ x }}, {{ y }} }</strong>\n        <br/>\n        <strong>Этот массив:</strong> {{ points }}\n        <br/>\n        <strong>Все массивы:</strong> {{ arr }}\n      </p>\n      <p>\n        i: {{ i }}\n        x: {{ x }}\n        y:{{ y }}\n      </p>\n    </div>\n\n    <button v-on:click=\"newArea\">Создать область</button>\n    <button v-on:click=\"closeArea\">Замкнуть область</button>\n    <button v-on:click=\"deleteArea\">Удалить область</button>\n  </div>\n</template>\n\n\n<script>\nimport JSMpeg from 'jsmpeg-player'\nconst fs = require(\"browserify-fs\");\nconst area_file = require('../public/data.json');\n\nexport default {\n  name: 'App',\n  components: {},\n  data: () => ({\n    points: [],\n    area_id: 0,\n    i: 0,\n    arr: [],\n    x: null, y: null,\n    canvas: null,\n    context: null,\n    isDrawing: false,\n  }),\n  mounted() {\n    let canvas = document.getElementById('videoCanvas');\n    let url = 'ws://192.168.1.100:5000';\n    let player = new JSMpeg.Player(url, {\n      canvas: canvas,\n      autoplay: true, audio: false, loop: true,\n      onVideoDecode: () => {\n      }\n    })\n\n    this.canvas = this.$refs.canvas\n    this.context = this.canvas.getContext(\"2d\");\n    this.context.lineWidth = 2;\n    this.context.strokeStyle = \"red\";\n    this.context.fillStyle = \"rgba(0,255,255,0.4)\"\n    this.canvas.addEventListener('click', this.click)\n    this.drawFromFile()\n  },\n  methods: {\n    newArea() {\n      // alert(\"Создание новой области\")\n      this.isDrawing = true;\n    },\n    closeArea: function () {\n      this.isDrawing = false;\n      var area = {\"id\": this.area_id, \"dots\": this.points}\n      this.arr.push(area)\n      // try { fs.writeFileSync('../public/data.json', JSON.stringify(this.points), 'utf-8'); }\n      // catch(e) { alert('Failed to save the file !'); }\n      // fs.writeFile('data.json',  JSON.stringify(this.points), 'utf8', function(err) {\n      //       if (err) throw err;\n      //       console.log('complete');\n      //     }\n      // );\n      // let data = JSON.stringify(this.points);\n      // fs.writeFileSync(\"../public/data.json\", this.points, 'utf8');\n\n\n\n      this.points = []\n      this.i = 0\n      this.x = 0;\n      this.y = 0;\n      this.context.closePath()\n      this.context.fill();\n      this.context.stroke();\n      // alert(\"Область замкнута\")\n    },\n    deleteArea() {\n      // this.canvas.clear()\n      //  НУЖНО ДОРАБОТАТЬ\n    },\n    click(e) {\n      if (!this.isDrawing) {\n        this.newArea()\n      }\n      if (this.isDrawing) {\n        var rect = this.canvas.getBoundingClientRect();\n        var x = e.clientX - rect.left;\n        var y = e.clientY - rect.top;\n        this.points.push({x, y})\n        if (this.i == 0) {\n          this.context.beginPath();\n          this.context.moveTo(x, y);\n        }\n        if (this.i > 0) {\n          this.context.lineTo(x, y);\n          this.context.stroke();\n          if (Math.abs(x - this.points[0].x) < 10 && Math.abs(y - this.points[0].y) < 10) {\n            this.points.pop()\n            this.closeArea()\n            return\n          }\n        }\n\n      }\n      this.i++\n    },\n    drawFromFile() {\n      this.arr.push(area_file)\n      this.area_id = this.arr.length\n      var points\n      for (var i = 0; i < this.arr.length; i++) {\n        points = this.arr[i].dots\n        this.context.beginPath()\n        this.context.moveTo(points[0].x, points[0].y);\n        for (var j = 1; j < points.length; j++) {\n          var x = points[j].x\n          var y = points[j].y\n          this.context.lineTo(x, y);\n        }\n        this.context.closePath()\n        this.context.fill();\n        this.context.stroke();\n      }\n\n    },\n  }\n}\n</script>\n\n<style>\nbody {\n  margin: 0;\n}\n\n.myCanvas {\n  position: absolute;\n  width: 1280px;\n  height: 640px;\n  top: 0;\n  left: 10px;\n}\n</style>"]}]}