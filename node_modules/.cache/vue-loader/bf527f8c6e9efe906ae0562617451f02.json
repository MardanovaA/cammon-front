{"remainingRequest":"/home/aigul/projects/rtsp_stream_v2/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/aigul/projects/rtsp_stream_v2/src/views/addController.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/aigul/projects/rtsp_stream_v2/src/views/addController.vue","mtime":1613948800721},{"path":"/home/aigul/projects/rtsp_stream_v2/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/aigul/projects/rtsp_stream_v2/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBjb250cm9sbGVycyBmcm9tICJAL3ZpZXdzL2NvbnRyb2xsZXJzIjsKZXhwb3J0IGRlZmF1bHQgewpuYW1lOiAiYWRkQ29udHJvbGxlci52dWUiLAogIHByb3BzOiBbJ2FycicsICdpZCddLAogIGNvbXBvbmVudHM6IHsKICAgIGNvbnRyb2xsZXJzCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgY29udHJvbGxlcnM6IFt7Y2lkOiAnMTInfSwge2NpZDogJ2thamJka2F3J30sIHtjaWQ6ICcxMjM0MjY3MzU3MTY0MjQyMSd9LCB7Y2lkOiAnMWFrbGpiZGFsa2p3YmQyMzQyNDIxJ31dLAogICAgICBzZWxlY3RlZERldmljZXM6IFtdLAogICAgICBjb2x1bW5zOiBbCiAgICAgICAge2tleTogJ2NpZCcsIGxhYmVsOiAnSUQnfSwKICAgICAgICB7a2V5OiAnYnV0dG9uMScsIGxhYmVsOiAn0J/QvtC00LDRgtGMINGB0LjQs9C90LDQuyd9LAogICAgICAgIHtrZXk6ICdidXR0b24yJywgbGFiZWw6ICfQktGL0LHRgNCw0YLRjCd9LAogICAgICBdLAogICAgICBncm91cEFsZXJ0OiBmYWxzZSwKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGFzeW5jIGdldEZyZWVEZXZpY2VzKCkgewogICAgICBsZXQgZGF0YSA9IHt9CiAgICAgIGZldGNoKGAvZnJlZURldmljZXNgLAogICAgICAgICAgewogICAgICAgICAgICBtZXRob2Q6ICJQT1NUIiwKICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoZGF0YSksCiAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLAogICAgICAgICAgICAgICdBY2NlcHQnOiAnYXBwbGljYXRpb24vanNvbicsCiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgKS50aGVuKHJlc3BvbnNlID0+IHsKCiAgICAgIH0pCiAgICB9LAogICAgYXN5bmMgY2hvb3NlRGV2aXZlKGlkKSB7CiAgICAgIGNvbnNvbGUubG9nKCdjaG9vc2luZyAnICsgaWQpOwogICAgICB0aGlzLnNlbGVjdGVkRGV2aWNlcy5wdXNoKHRoaXMuY29udHJvbGxlcnNbaWRdKQogICAgICB0aGlzLmNvbnRyb2xsZXJzLnNwbGljZShpZCwgMSkKICAgIH0sCiAgICBhc3luYyBkZWxldGVEZXZpdmUoaWQsIGNpZCkgewogICAgICBjb25zb2xlLmxvZygnZGVsZXRpbmcgJyArIGlkKTsKICAgICAgdGhpcy5jb250cm9sbGVycy5wdXNoKHRoaXMuc2VsZWN0ZWREZXZpY2VzW2lkXSkKICAgICAgdGhpcy5yZW1vdmVCeUF0dHIodGhpcy5zZWxlY3RlZERldmljZXMsICdjaWQnLCBjaWQpCiAgICB9LAogICAgYXN5bmMgcmVtb3ZlQnlBdHRyKGFyciwgYXR0ciwgdmFsdWUpewogICAgICB2YXIgaSA9IGFyci5sZW5ndGg7CiAgICAgIHdoaWxlKGktLSl7CiAgICAgICAgaWYoIGFycltpXQogICAgICAgICAgICAmJiBhcnJbaV0uaGFzT3duUHJvcGVydHkoYXR0cikKICAgICAgICAgICAgJiYgKGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFycltpXVthdHRyXSA9PT0gdmFsdWUgKSApewogICAgICAgICAgYXJyLnNwbGljZShpLDEpOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gYXJyOwogICAgfSwKICAgIGJsaW5rKGlkKSB7CiAgICAgIGNvbnNvbGUubG9nKCdibGluayAnICsgaWQpCiAgICAgIGxldCBkYXRhID0gewogICAgICAgIGlkOiBpZAogICAgICB9CiAgICAgIGZldGNoKGAvYmxpbmtgLAogICAgICAgICAgewogICAgICAgICAgICBtZXRob2Q6ICJQT1NUIiwKICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoZGF0YSksCiAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLAogICAgICAgICAgICAgICdBY2NlcHQnOiAnYXBwbGljYXRpb24vanNvbicsCiAgICAgICAgICAgICAgJ2lkJzogaWQsCiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgKQogICAgfSwKICAgIGFzeW5jIGFkZENvbnRyb2xsZXIoYXJyLCBkZXZpY2VzKXsKICAgICAgY29uc29sZS5sb2coYXJyKQogICAgICBjb25zb2xlLmxvZyhkZXZpY2VzKQogICAgfSwKICAgIGFzeW5jIGNyZWF0ZUdyb3VwKCkgewogICAgICBsZXQgZGF0YSA9IHsKICAgICAgICBncm91cDogdGhpcy5zZWxlY3RlZERldmljZXMKICAgICAgfQogICAgICBmZXRjaChgL2NyZWF0ZUdyb3VwYCwKICAgICAgICAgIHsKICAgICAgICAgICAgbWV0aG9kOiAiUE9TVCIsCiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGRhdGEpLAogICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJywKICAgICAgICAgICAgICAnQWNjZXB0JzogJ2FwcGxpY2F0aW9uL2pzb24nLAogICAgICAgICAgICAgICdyb29tTmFtZSc6IHRoaXMucm9vbU5hbWUsCiAgICAgICAgICAgICAgJ3NzaWQnOiAiU3RhckxpZ2h0XyIgKyB0aGlzLmFwX3NzaWQsCiAgICAgICAgICAgICAgJ3Bhc3MnOiB0aGlzLmFwX3Bhc3MsCiAgICAgICAgICAgICAgJ3Rva2VuJzogdGhpcy50b2tlbgogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgY29uc29sZS5sb2coJ3J1biBjcmVhdGUgZ3JvdXAnKQogICAgICAgIHRoaXMuJHBhcmVudC5zaG93QWxlcnQoJ9CT0YDRg9C/0L/QsCDRgdC+0LfQtNCw0LXRgtGB0Y8sINC/0L7QtNC+0LbQtNC40YLQtScsIDIwMCwgJ3N1Y2Nlc3MnKQogICAgICB9KQogICAgfSwKICB9Cn0K"},{"version":3,"sources":["addController.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"addController.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"addController\">\n    {{arr}}\n    <div>\n      <b-row class=\"p-2\">\n        <b-col>\n            <h5>Доступные устройства ({{ controllers.length }})</h5>\n            <div class=\"p-2\">\n              <b-table responsive fixed :items=\"controllers\" :fields=\"columns\" table-variant=\"secondary\">\n                <template #cell(button1)=\"row\">\n                  <b-button size=\"sm\" class=\"mr-2\" @click=\"blink(row.item.cid)\">\n                    Сигнал\n                  </b-button>\n                </template>\n                <template #cell(button2)=\"row\">\n                  <b-button size=\"sm\" @click=\"chooseDevive(row.index)\" class=\"mr-2\">\n                    Добавить\n                  </b-button>\n                </template>\n              </b-table>\n            </div>\n        </b-col>\n        <b-col>\n          <div>\n            <h5>Выбранные устройства ({{ selectedDevices.length }})</h5>\n            <div class=\"p-2\">\n              <b-table responsive :items=\"selectedDevices\" :fields=\"columns\" table-variant=\"secondary\">\n                <template #cell(button1)=\"row\">\n                  <b-button size=\"sm\" class=\"mr-2\" @click=\"blink(row.item.cid)\">\n                    Сигнал\n                  </b-button>\n                </template>\n                <template #cell(button2)=\"row\">\n                  <b-button size=\"sm\" @click=\"deleteDevive(row.index, row.item.cid)\" class=\"mr-2\">\n                    Удалить\n                  </b-button>\n                </template>\n              </b-table>\n            </div>\n          </div>\n        </b-col>\n      </b-row>\n    </div>\n\n\n    <div class=\"my-3\">\n      <b-card class=\"bg-sec\">\n        <div class=\"text-center mt-2\">\n          <b-button variant=\"dark\" @click=\"addController(arr, selectedDevices)\">Прикрепить к {{arr.length}} областям</b-button>\n        </div>\n      </b-card>\n<!--      <div v-if=\"groupAlert\" class=\"fixed-top w-100 h-100\" style=\"z-index: 5; background-color: rgba(0,0,0,0.7)\" />-->\n<!--      <b-alert-->\n<!--          dismissible-->\n<!--          v-model=\"groupAlert\"-->\n<!--          variant=\"dark\"-->\n<!--          class=\"position-fixed\"-->\n<!--          style=\"top: 10vh; left: 10vw; width: 80vw; height: 80vh; z-index: 10; padding: 5%;\"-->\n<!--      >-->\n<!--        <div class=\"my-3\">-->\n<!--          <h3>Создание группы</h3>-->\n<!--          <div class=\"px-2\">-->\n<!--            <h5>Выбранные устройства: </h5>-->\n<!--            <div class=\"text-center mt-4\">-->\n<!--              <b-button variant=\"dark\" @click=\"createGroup()\">Создать группу</b-button>-->\n<!--            </div>-->\n<!--          </div>-->\n<!--        </div>-->\n<!--      </b-alert>-->\n    </div>\n  </div>\n</template>\n\n<script>\nimport controllers from \"@/views/controllers\";\nexport default {\nname: \"addController.vue\",\n  props: ['arr', 'id'],\n  components: {\n    controllers\n  },\n  data() {\n    return {\n      controllers: [{cid: '12'}, {cid: 'kajbdkaw'}, {cid: '12342673571642421'}, {cid: '1akljbdalkjwbd2342421'}],\n      selectedDevices: [],\n      columns: [\n        {key: 'cid', label: 'ID'},\n        {key: 'button1', label: 'Подать сигнал'},\n        {key: 'button2', label: 'Выбрать'},\n      ],\n      groupAlert: false,\n    }\n  },\n  methods: {\n    async getFreeDevices() {\n      let data = {}\n      fetch(`/freeDevices`,\n          {\n            method: \"POST\",\n            body: JSON.stringify(data),\n            headers: {\n              'Content-Type': 'application/json',\n              'Accept': 'application/json',\n            }\n          }\n      ).then(response => {\n\n      })\n    },\n    async chooseDevive(id) {\n      console.log('choosing ' + id);\n      this.selectedDevices.push(this.controllers[id])\n      this.controllers.splice(id, 1)\n    },\n    async deleteDevive(id, cid) {\n      console.log('deleting ' + id);\n      this.controllers.push(this.selectedDevices[id])\n      this.removeByAttr(this.selectedDevices, 'cid', cid)\n    },\n    async removeByAttr(arr, attr, value){\n      var i = arr.length;\n      while(i--){\n        if( arr[i]\n            && arr[i].hasOwnProperty(attr)\n            && (arguments.length > 2 && arr[i][attr] === value ) ){\n          arr.splice(i,1);\n        }\n      }\n      return arr;\n    },\n    blink(id) {\n      console.log('blink ' + id)\n      let data = {\n        id: id\n      }\n      fetch(`/blink`,\n          {\n            method: \"POST\",\n            body: JSON.stringify(data),\n            headers: {\n              'Content-Type': 'application/json',\n              'Accept': 'application/json',\n              'id': id,\n            }\n          }\n      )\n    },\n    async addController(arr, devices){\n      console.log(arr)\n      console.log(devices)\n    },\n    async createGroup() {\n      let data = {\n        group: this.selectedDevices\n      }\n      fetch(`/createGroup`,\n          {\n            method: \"POST\",\n            body: JSON.stringify(data),\n            headers: {\n              'Content-Type': 'application/json',\n              'Accept': 'application/json',\n              'roomName': this.roomName,\n              'ssid': \"StarLight_\" + this.ap_ssid,\n              'pass': this.ap_pass,\n              'token': this.token\n            }\n          }\n      ).then(response => {\n        console.log('run create group')\n        this.$parent.showAlert('Группа создается, подождите', 200, 'success')\n      })\n    },\n  }\n}\n</script>"]}]}